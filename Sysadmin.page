---
format: markdown
title: Sysadmin a Gconfs
categories: base
---

Gconfs g√®re des outils pour ses membres. A partir de ce moment, se pose la
question de l'administration des syst√®mes et des outils en question.

## Nom de domaine

<!--TODO -->

## Autoh√©bergement - Serveur CRI

Une VM est pr√™t√©e a Gconfs par le CRI. C'est un petit truc avec 2 CPU et 1Go de
RAM, mais c'est d√©j√† pas mal pour ce qu'on veut en faire. Dessus on host a peu
pr√®s tout ce qui est pas trop chiant a hoster, en configurant le tout avec
[Ansible](https://www.ansible.com)

### Site web Gconfs

#### Comment √ßa marche?

Le [site de Gconfs](https://gconfs.fr) est fait avec
[Hyde](https://hyde.github.io), le d√©pot correspondant se trouve
[ici](https://github.com/gconfs/website-hyde). Y avait un projet de le remplacer
par un site en django mais y a pas trop de nouvelles. Le d√©ploiement du site sur
le serveur est fait automatiquement avec le playbook ansible `website`, qui git
clone et reg√©n√®re le site automatiquement.

#### Comment mettre a jour le contenu

Du coup, pour updater le site il faut modifier le d√©pot, **v√©rifier que √ßa
compile correctement**, push sur le d√©pot github, puis puller depuis le serveur
en utilisant le playbook (`sudo ansible-playbook
/etc/ansible/playbooks/website.yml`)

### Wiki Gconfs

#### Comment √ßa marche?

Le [wiki de Gconfs](https://wiki.gconfs.fr) utilise
[gitit](https://github.com/jgm/gitit). Les donn√©es du wiki sont donc stock√©es
dans git, et il faudrait setup un push vers github en parallelle pour avoir une
version master. Il peut se d√©ployer via le playbook wiki (`sudo ansible-playbook
/etc/ansible/playbooks/wiki.yml`), mais ne clone pas (encore?) le contenu
directement depuis github.

#### Comment mettre a jour le contenu

Pour √©diter le wiki, il est bien sur possible d'utiliser l'interface web, mais
on peut aussi git clone le d√©pot qui contient les donn√©es (`git clone
gconfs.fr:/srv/gitit/wikidata wiki_gconfs`) (quand on a un compte sur le
serveur, s'entend), √©diter le texte, puis le push sur le serveur a nouveau, ce
qui mettra a jour la version web dynamiquement. √áa s'√©crit en markdown.

<!-- TODO: cr√©er des creds automatis√©s, et uncomment le hook post-receive pour
push sur github -->

### Vault

#### Comment √ßa marche?

Le [vault](https://vault.gconfs.fr) sert a conserver les mots de passe des
diff√©rents comptes utilis√©s par Gconfs, pour qu'ils soient partag√©s entre les
sysadmins et le bureau et transmis facilement. Le tout est g√©r√© par
[passbolt](https://github.com/passbolt/passbolt_api). Les mots de passe sont
stock√©s chiffr√©s avec GPG.

#### Cr√©er un compte

Pour avoir un compte, il faut demander a quelqu'un qui a la main sur le serveur
(pour l'instant). Il lancera alors la commande magique (`sudo -H -u www-data
/srv/vault/bin/cake passbolt register_user -u [email] -f [pr√©nom] -l [nom] -r
[role(user ou admin)]`) et √ßa lui donnera une URL, qu'il pourra transmettre a la
personne qui veut cr√©er le compte pour qu'elle l'active.

#### Comment je l'utilise

Passbolt fonctionne avec une extension navigateur et des applis
android/iOS/whatever. Il *faut* avoir l'extension pour consulter les
mots de passe et pour cr√©er son compte. Lors de l'activation du compte, une cl√©
GPG est cr√©√©e (en js dans le browser), et sera utilis√©e pour d√©chiffrer les mots
de passe pr√©sents sur le vault. √áa filera aussi un ensemble (couleur + trois
lettres) qui est utilis√© pour identifier passbolt quand il demande un mot de
passe. Apr√®s avoir sauvegard√© la cl√© GPG, la passphrase et cet ensemble (couleur
+ lettres), bah il suffit d'aller sur [vault](https://vault.gconfs.fr) et
a commencer a stocker/partager des mots de passe.

<!-- TODO: Foutre un serveur mail quelque part et configurer les mails sur
passbolt pour permettre de cr√©er des comptes depuis l'UI web -->


### Pad

Le [pad](https://pad.gconfs.fr) sert a, euh, √©crire des trucs de mani√®re
collaborative. C'est g√©r√© par [CodiMD](https://github.com/hackmdio/codimd).

#### Cr√©er un compte

On va sur la page d'acceil, on clique sur log in, on rentre ses infos, et on
clique sur register. Done.

#### Comment je l'utilise

L'interface de base comprend un panel a gauche √©ditable en markdown, et un panel
a droite qui affiche le r√©sultat HTML. Les couleurs correspondantes aux
diff√©rentes personnes √©ditant le document sont tout a gauche du panel d'√©dition,
et euh voil√† quoi ü§∑‚Äç‚ôÇÔ∏è


## Les trucs externes

### Slack

Avant, on avait un channel IRC sur r√©zosup. Depuis quelques ann√©es, Gconfs est
pass√© a [Slack](https://gconfs.slack.com). Bah c'est slack quoi.

### Google

Les comptes email @gconfs.fr sont g√©r√©s par gmail, tout comme les mailing lists
@gconfs.fr. C'est un compte gsuite associatif, mais on utilise vraiment que
Gmail et google drive pour stocker des fichiers partag√©s.
